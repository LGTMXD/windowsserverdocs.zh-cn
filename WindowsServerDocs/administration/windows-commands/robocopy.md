---
title: robocopy
description: 了解如何使用 Windows 和 Windows Server 中的 robocopy 命令复制文件
ms.topic: article
ms.assetid: d4c6e8e9-fcb3-4a4a-9d04-2d8c367b6354
author: jasongerend
ms.author: jgerend
manager: lizapo
ms.date: 06/07/2020
ms.openlocfilehash: fdf7eda5a17dccba0f43cca91cae122872dd5235
ms.sourcegitcommit: 53d526bfeddb89d28af44210a23ba417f6ce0ecf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/06/2020
ms.locfileid: "87883493"
---
# <a name="robocopy"></a>robocopy

复制文件数据。

## <a name="syntax"></a>语法

```
robocopy <Source> <Destination> [<File>[ ...]] [<Options>]
```

例如，若要将名为*yearly-report*的文件从 c:\reports 复制到文件共享 (* \\ marketing\videos*) ，同时为更高的性能 (启用多线程处理使用/mt 参数) 并且能够在中断后重启传输 (使用/z 参数) ，你将使用以下语法：

```dos
robocopy C:\reports '\\marketing\videos' yearly-report.mov /mt /z
```

### <a name="parameters"></a>参数

|   参数    |                                                                                            描述                                                                                           |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   \<Source>    |                                                                            指定源目录的路径。                                                                           |
| \<Destination> |                                                                          指定目标目录的路径。                                                                        |
|    \<File>     | 指定要复制的一个或哪些文件。 如果需要，可以使用 (**&#42;** 或 **？**) 的通配符。 如果未指定**文件**参数，则将** \* . \* **用作默认值。 |
|   \<Options>   |                                                                    指定要与**robocopy**命令一起使用的选项。                                                                   |

### <a name="copy-options"></a>复制选项

|选项|说明|
|------|-----------|
|/s|复制子目录。 请注意，此选项不包括空目录。|
|/e|复制子目录。 请注意，此选项包含空目录。 有关其他信息，请参阅 "[备注](#remarks)"。|
|列弗\<N>|仅复制源目录树的前*N*个级别。|
|/z|在可重启模式下复制文件。|
|/b|以备份模式复制文件。|
|/zb|使用可重新启动模式。 如果访问被拒绝，此选项将使用备份模式。|
|/efsraw|复制 EFS RAW 模式下的所有加密文件。|
|/copy\<CopyFlags>|指定要复制的文件属性。 下面是此选项的有效值：</br>**D**数据</br>**特性**</br>**T**时间戳</br>**S** NTFS 访问控制列表 (ACL) </br>**O**所有者信息</br>**U**审核信息</br>**CopyFlags**的默认值为) ** (的**数据、属性和时间戳。|
|/dcopy:\<copyflags\>|定义要为目录复制的内容。 默认值为 DA。 选项为 D = data、A = 属性和 T = 时间戳。|
|/秒|复制安全 (等效于 **/copy： dat**) 的文件。|
|/copyall|复制 (等效于 **/copy： DATSOU**) 的所有文件信息。|
|/nocopy|不复制任何文件信息 (对 **/purge**) 有用。|
|/secfix|修复了所有文件的文件安全问题，甚至会跳过文件。|
|/timfix|修复所有文件上的文件时间，甚至是跳过的文件。|
|/purge|删除源中不再存在的目标文件和目录。 有关其他信息，请参阅 "[备注](#remarks)"。|
|/mir|镜像目录树 (等效于 **/e** plus **/purge**) 。 有关其他信息，请参阅 "[备注](#remarks)"。|
|/mov|移动文件，并在复制后从源中删除它们。|
|/move|移动文件和目录，并在复制后从源中删除这些文件和目录。|
|/a +： [RASHCNET]|将指定的属性添加到复制的文件。|
|/a-： [RASHCNET]|从复制的文件中删除指定的属性。|
|/create|仅创建目录树和长度为零的文件。|
|/fat|仅使用8.3 的字符长度 FAT 文件名创建目标文件。|
|/256|关闭对非常长的路径的支持 (长度超过256个字符) 。|
|月\<N>|监视源，并在检测到超过*N*个更改时再次运行。|
|/mot:\<M>|监视源，如果检测到更改，则在*M*分钟内再次运行。|
|/MT[:N]|用*N*个线程创建多线程副本。 *N*必须是介于1到128之间的整数。 *N*的默认值为8。</br>**/Mt**参数不能与 **/IPG**和 **/EFSRAW**参数一起使用。</br>使用 **/log**选项重定向输出以提高性能。</br>注意：/MT 参数适用于 Windows Server 2008 R2 和 Windows 7。|
|/rh： hhmm-hhmm|指定可能启动新副本时的运行时间。|
|/pf|检查每个文件上的运行时间 (不按) 。|
|/ipg： n|指定在慢速线路上释放带宽的数据包间间隔。|
|/sl|不要跟踪符号链接，而是创建链接的副本。|

> [!IMPORTANT]
> 使用 **/SECFIX** copy 选项时，还可以通过使用以下附加复制选项之一来指定要复制的安全信息类型：
>- **/COPYALL**
>- **/COPY： O**
>- **/COPY： S**
>- **/COPY： U**
>- **秒**

### <a name="file-selection-options"></a>文件选择选项

|选项|描述|
|------|-----------|
|/a|仅复制为其设置了**存档**属性的文件。|
|/m|仅复制设置了**存档**属性的文件，并重置**存档**属性。|
|/ia:[RASHCNETO]|仅包括为其设置了任何指定属性的文件。|
|/xa:[RASHCNETO]|排除为其设置了任何指定属性的文件。|
|/xf \<FileName> [...]|排除匹配指定名称或路径的文件。 请注意，*文件名*可以包含 (**&#42;** 和 **？**) 的通配符。|
|/xd \<Directory> [...]|排除匹配指定名称和路径的目录。|
|/xc|排除已更改的文件。|
|/xn|排除较新的文件。|
|/xo|排除较旧的文件。|
|/xx|排除多余的文件和目录。|
|/xl|排除 "孤立的" 文件和目录。|
|/is|包括相同的文件。|
|/it|包括 "调整" 文件。|
|数量\<N>|指定 (的最大文件大小以排除超过*N*个) 的文件。|
|/min\<N>|指定 (以排除小于*N*个字节) 的文件的最小文件大小。|
|maxage\<N>|指定要排除早于*N*天或日期) 的文件 (最长文件保留时间。|
|/minage:\<N>|指定 "最短文件保留时间" (排除晚于*N*天或日期) 的文件。|
|/maxlad:\<N>|指定最大上次访问日期 (排除自*N*) 以来未使用的文件。|
|/minlad:\<N>|指定最小的上次访问日期 (排除*使用的文件*，因为 n) 如果*n*小于1900，*则 n 指定*天数。 否则， *N*以 YYYYMMDD 格式指定日期。|
|/xj|排除联接点，默认情况下这些联接点通常包括在内。|
|/fft|采用 FAT 文件时间（精度为两秒）。|
|/dst|补偿一小时的 DST 时间差异。|
|/xjd|排除目录的交接点。|
|/xjf|排除文件的交接点。|

### <a name="retry-options"></a>重试选项

|选项|描述|
|------|-----------|
|/r\<N>|指定复制失败时的重试次数。 *N*的默认值为 1000000 (1000000 重试) 。|
|/w\<N>|指定等待重试的间隔时间，以秒为单位。 *N*的默认值为 30 (等待时间) 为30秒。|
|/reg|将 **/r**和 **/w**选项中指定的值保存为注册表中的默认设置。|
|/tbd|指定系统将等待定义共享名称 (重试错误 67) 。|

### <a name="logging-options"></a>日志记录选项

|选项|描述|
|------|-----------|
|/l|指定只列出 (，而不会对文件进行) 复制、删除或时间戳。|
|/x|报告所有多余的文件，而不仅仅是所选的文件。|
|/v|生成详细输出，并显示跳过的所有文件。|
|/ts|在输出中包括源文件时间戳。|
|/fp|在输出中包括文件的完整路径名称。|
|/bytes|将大小打印为字节。|
|/ns|指定不记录文件大小。|
|/nc|指定不记录文件类。|
|/nfl|指定不记录文件名。|
|/ndl|指定不记录目录名。|
|/np|指定不要显示复制操作的进度（到目前为止复制的文件或目录数）。|
|/eta|显示所复制文件 (ETA) 的预计到达时间。|
|/log\<LogFile>|将状态输出写入到日志文件（覆盖现有的日志文件）。|
|/log +：\<LogFile>|将状态输出写入日志文件 (将输出追加到现有日志文件) 。|
|/unicode|将状态输出显示为 Unicode 文本。|
|/unilog:\<LogFile>|将状态输出作为 Unicode 文本写入日志文件 (覆盖现有日志文件) 。|
|/unilog +：\<LogFile>|将状态输出作为 Unicode 文本写入日志文件 (将输出追加到现有日志文件) 。|
|/tee|将状态输出写入控制台窗口以及日志文件。|
|/njh|指定没有作业标头。|
|/njs|指定没有作业摘要。|

### <a name="job-options"></a>作业选项

|选项|描述|
|------|-----------|
|/作业\<JobName>|指定参数将从命名作业文件派生。|
|把\<JobName>|指定将参数保存到指定的作业文件中。|
|/quit|处理命令行 (后退出，以便查看) 的参数。|
|/nosd|指示未指定源目录。|
|/nodd|指示未指定目标目录。|
|/if|包含指定的文件。|

### <a name="exit-return-codes"></a>退出 (返回) 代码

值 | 描述
-- | --
0 | 未复制文件。 未遇到任何故障。  没有文件不匹配。 文件已存在于目标目录中;因此，已跳过复制操作。
1 | 已成功复制所有文件。
2 | 目标目录中有一些其他文件在源目录中不存在。 未复制文件。
3 | 已复制某些文件。 存在其他文件。 未遇到任何故障。
5 | 已复制某些文件。 某些文件不匹配。 未遇到任何故障。
6 | 其他文件和文件不匹配。 未复制任何文件，但未遇到任何故障。 这意味着文件已经存在于目标目录中。
7 | 文件已复制，存在文件不匹配，并存在其他文件。
8 | 几个文件没有复制。

> [!NOTE]
> 任何大于8的值都表示在复制操作过程中至少出现一次失败。

### <a name="remarks"></a>备注

-   **/Mir**选项等效于 **/e**加 **/purge**选项，其行为有一小不同：
    -   借助 **/e** plus **/purge**选项，如果目标目录存在，则不会覆盖目标目录安全设置。
    -   对于 **/mir**选项，如果目标目录存在，则将覆盖目标目录安全设置。

## <a name="additional-references"></a>其他参考

- [命令行语法项](command-line-syntax-key.md)
