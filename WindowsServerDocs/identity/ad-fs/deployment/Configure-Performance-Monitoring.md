---
ms.assetid: 67d8a8d7-2fbd-4ed7-bb41-75769f942024
title: 配置性能监视
author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.author: billmath
ms.openlocfilehash: bf6038fe5aec1bda815921c074b0c89d69732999
ms.sourcegitcommit: dfa48f77b751dbc34409aced628eb2f17c912f08
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/07/2020
ms.locfileid: "87938403"
---
# <a name="configure-performance-monitoring"></a>配置性能监视

## <a name="bkmk_ConfigurePerfMon"></a>
AD FS 包括其自己的专用性能计数器，以帮助你监视联合服务器和联合服务器代理计算机的性能。 若要使用性能监视器监视 AD FS 服务器的性能，请创建新的数据收集器集，并将 AD FS 计数器添加到该视图中。 下面的过程介绍如何配置 AD FS 的性能监视。

#### <a name="to-configure-performance-monitoring-for-ad-fs-using-performance-monitor"></a>使用性能监视器配置 AD FS 的性能监视

1. 在 "**开始**" 屏幕上，键入 "**性能监视器**"，然后按 enter。

2. 在控制台树中，展开 "**数据收集器集**"，右键 \- 单击 "**用户定义**"，指向 "**新建**"，然后单击 "**数据收集器集**"。

   此时将显示 "创建新数据收集器集向导"。

3. 在 "新建**数据收集器集**" 中，为 "**名称**" 键入新数据收集器集的名称， \( 例如 "AD FS 性能" \) ** \( \) **，单击 "手动创建"，然后单击 "**下一步**"。

4. 对于要包含的数据类型，请验证是否已选中 "**创建数据日志**"，然后单击以下数据类型对应的复选框： "**性能计数器**"、"**事件跟踪数据**"、"**系统配置信息**"。

5. 对于性能计数器，请在 "**可用的计数器**" 列表中展开**AD FS** ，然后单击 "**添加**"。

   AD FS 性能计数器应显示在添加的**计数器**列表中。

6. 当系统提示你添加事件跟踪提供程序时，单击 "**添加**"，从提供程序列表中选择**AD FS 事件**并**AD FS 跟踪**。

7. 当系统提示你添加要监视的注册表项时，单击 "**下一步**"。

8. 系统提示指定保存性能数据的位置时，可以接受默认位置 \( **% systemdrive% \\ PerfLogs \\ Admin \\ ** _<数据 \_ 收集器 \_ 集>_，然后单击 "**下一步**"。

9. 如果系统提示你创建数据收集器集，请选择 "**保存并关闭**"，然后单击 "**完成**"。

    新数据收集器集出现在控制台树中的 "**用户定义**" 节点下。

10. 使用以下步骤来处理 AD FS 性能计数器：

    -   若要使用 AD FS 相关计数器开始性能监视 \- ，请右键 \- 单击添加的数据收集器集 \( （如 "AD FS 性能" \) ），然后单击 "**启动**"。

    -   若要创建报表来查看性能监视结果，请右键 \- 单击添加的数据收集器集 \( （如 "AD FS 性能" \) ），然后单击 "**最新报表**"。

    -   若要结束性能数据的捕获以便查看最新报告，请右键 \- 单击添加的数据收集器集 \( （如 "AD FS 性能" \) ），然后单击 "**停止**"。

    将自动添加最新报表，并 \( 从 \) 控制台树中的 "**报表 \\ 用户定义**<em> \\<数据 \_ 收集器 \_ 集></em> " 节点下的000001开始编号。

## <a name="ad-fs-performance-counters"></a>AD FS 性能计数器
下表列出了 AD FS 性能计数器，并说明了它们对于监视与联合服务器或联合服务器代理相关的活动非常有用。

|计数器|说明|可用于：
|-----------|---------------|-------------------
|令牌请求|监视发送到联合服务器的令牌请求数，包括 SSOAuth 令牌请求。|联合服务器
|令牌请求 \/ 秒|监视发送到联合服务器的令牌请求数，包括每秒 SSOAuth 令牌请求数。|联合服务器
|联合元数据请求|监视发送到联合服务器的传入联合元数据请求数。|联合服务器
|每秒联合元数据请求数 \/|监视发送到联合服务器的每秒传入的联合元数据请求数。|联合服务器
|项目解析请求|监视发送到联合服务器的每秒传入的联合元数据请求数。|联合服务器
|每秒项目解析请求数 \/|监视发送到联合服务器的项目解析终结点的请求数。|联合服务器
|代理请求|监视发送到联合服务器代理的传入请求数。|联合服务器代理
|代理请求 \/ 秒|监视发送到联合服务器代理的每秒传入请求数。|联合服务器代理
|代理 MEX 请求|监视 \- \( \) 发送到联合服务器代理的传入 WS 元数据交换 MEX 请求数。|联合服务器代理
|代理 MEX 请求 \/ 秒|监视发送到联合服务器代理的每秒传入 MEX 请求数。|联合服务器代理


