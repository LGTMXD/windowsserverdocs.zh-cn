---
title: Windows Server 2016 中 Windows 控制台的新增功能
description: 列出 Windows Server 2016 控制台中的重要新功能。
ms.prod: windows-server
ms.technology: server-general
ms.date: 10/04/2016
ms.topic: article
ms.assetid: da9fc582-033b-4973-84e7-0c6024ecfcbc
author: jaimeo
ms.author: jaimeo
manager: dongill
ms.localizationpriority: medium
ms.openlocfilehash: b055c379e1d5ee632e420ffd1362389878d3dfd1
ms.sourcegitcommit: 3a3d62f938322849f81ee9ec01186b3e7ab90fe0
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2020
ms.locfileid: "80825960"
---
# <a name="whats-new-in-the-windows-console-in-windows-server-2016"></a>Windows Server 2016 中 Windows 控制台的新增功能
>适用于：Windows Server 2016

控制台主机（支持所有字符模式的应用程序的基础代码，包括 Windows 命令提示符、Windows PowerShell 提示符等）已通过几种方式进行更新，以添加各种新功能。  

## <a name="controlling-the-new-features"></a>控制新功能  
新功能为默认启用，但可以通过“属性”界面（主要是在“**选项**”选项卡上）或使用这些注册表项（所有表项都是 **HKEY_CURRENT_USER\Console** 下的 DWORD 值）打开和关闭每个新功能或恢复到以前的控制台主机：  

|注册表项|说明|  
|----------------|---------------|  
|ForceV2|1 启用所有新的控制台功能；0 禁用所有新功能。 注意：此值不存储于快捷方式中，仅存储在此注册表项中。|  
|LineSelection|1 启用行选择；0 仅限使用块模式|  
|FilterOnPaste|1 启用新的粘贴行为|  
|LineWrap|当调整控制台窗口大小时 1 进行文本换行|  
|CtrlKeyShortcutsDisabled|0 启用新键的快捷方式；1 禁用|  
|ExtendedEdit 键|1 启用完整键盘选择键集；0 禁用|  
|TrimLeadingZeros|1 通过双击削减选择中的前导零串；0 保留前导零串|  
|WindowsAlpha|设置 30% 到 100% 之间的不透明度值。 使用 0x4C 到 0xFF 或 76 到 255 以指定值|  
|WordDelimiters|定义通过 CTRL + SHIFT + ARROW 一次选择整个单词文本时用于跳过的字符（默认为空格字符）。 设置此 REG_SZ 值，以包含想要被视为分隔符的所有字符。 注意：此值不存储于快捷方式中，仅存储在此注册表项中。|  

这些设置存储在 HKCU\Console 下注册表中的每个窗口标题。 快捷方式打开的控制台窗口具有这些存储在快捷方式中的设置；如果该快捷方式复制到另一台计算机，这些设置将随之移动到新的计算机。 快捷方式中的设置将覆盖所有其他设置，包括全局设置和默认设置。 但是，如果要使用“**选项**”选项卡中的“**使用传统控制台**”恢复到原始控制台，则此设置为全局设置，之后将对所有窗口保持不变，包括重启计算机后。  

可以通过适当配置 Unattend 文件中的注册表或使用 Windows PowerShell 来预配置设置或编写脚本。  

16 位 NTVDM 应用始终恢复到旧版控制台主机。  

> [!NOTE]  
> 如果使用新的控制台设置遇到问题，且无法通过此处列出的任何特定选项解决，可以始终通过将 ForceV2 设置为 0 或使用“**选项**”中的“**使用传统控制台**”控件来恢复到原始控制台。  

## <a name="console-behavior"></a>控制台行为  
现在，可以使用鼠标抓取边缘并拖动它来随意调整控制台窗口的大小。 只有在手动设置窗口尺寸（通过使用“**属性**”中的“**布局**”选项卡），或当缓冲区中的最长文本行宽于当前窗口大小时，才会显示滚动条。  

新的控制台窗口现在支持自动换行。 但是，如果使用控制台 API 来更改缓冲区中的文本，控制台将按文本最初插入的格式保留它。  

控制台窗口现在可以是半透明的（最低 30% 的透明度）。 可以从“属性”菜单或使用以下键盘命令调整透明度：  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|增加透明度|CTRL + SHIFT + 加号 (+) 或 CTRL + SHIFT + 鼠标向上滚动|  
|降低透明度|CTRL + SHIFT + 减号 (-) 或 CTRL + SHIFT + 鼠标向下滚动|  
|切换全屏显示模式|ALT + ENTER|  

## <a name="selection"></a>选择  
有许多新的选项用于选择文本和行，以及用于标记文本和使用缓冲区历史记录。 控制台将尝试避免与可能正在使用相同键的应用程序发生冲突。  

**对于开发人员：** 如果发生冲突，通常可以通过 SetConsoleMode() API 控制应用程序的行输入、处理输入和回显输入模式的使用行为。 如果在处理输入模式下运行，可使用下面的快捷方式，但在其他模式下，应用程序必须对其进行处理。 任何未在此处列出的组合键与在旧版控制台中的功能相同。 还可以尝试使用“**选项**”选项卡上的不同设置来解决冲突。如果所有其他方法均失败，可以随时恢复到原始控制台。  

现在可以在快速编辑模式之外使用“单击拖动”选择功能，并且此选择功能可以像在记事本中那样跨行选择文本，而不仅仅是选择矩形块。 复制操作不再需要删除换行符。 除了“单击拖动”选择功能外，还有以下组合键可用：  

**文本选择**  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|将光标向左移动一个字符，扩展选择范围|SHIFT + 向左键|  
|将光标向右移动一个字符，扩展选择范围|SHIFT + 向右键|  
|从插入点逐行选择文本|SHIFT + 向上键|  
|将文本选择范围从插入点向下扩展一行|SHIFT + 向下键|  
|如果光标位于当前正在编辑的行中，使用一次此命令可将所选内容扩展到输入行中的最后一个字符。 第二次使用此命令可将所选内容扩展到右边距。|SHIFT + END|  
|如果光标**不**位于当前正在编辑的行中，使用此命令可选择从插入点到右边距的所有文本。|SHIFT + END|  
|如果光标位于当前正在编辑的行中，使用一次此命令可立即将所选内容扩展到命令提示符后的字符。 第二次使用此命令可将所选内容扩展到右边距。|SHIFT + HOME|  
|如果光标**不**位于当前正在编辑的行中，使用此命令可将所选内容扩展到左边距。|SHIFT + HOME|  
|将所选内容向下扩展一个屏幕|SHIFT + Page Down|  
|将所选内容向上扩展一个屏幕|SHIFT + PAGE UP|  
|将所选内容向右扩展一个单词 （可以使用 WordDelimiters 注册表项为 word 定义分隔符。）|CTRL + SHIFT + 向右键|  
|将所选内容向左扩展一个单词|CTRL + SHIFT + HOME|  
|将所选内容扩展到屏幕缓冲区的开头|CTRL + SHIFT + END|  
|如果光标位于当前行并且行不为空时，将选择提示符后的所有文本|CTRL + A|  
|如果光标**不**在当前行中，则选择整个缓冲区|CTRL + A|  

**编辑文本**  

可以使用键盘命令在控制台中复制和粘贴文本。 CTRL + C 现在提供两个功能。 如果使用时没有选定任何文本，它将照常发送换行命令。 如果选定文本，第一次使用将复制文本并清除所选内容；第二次使用将发送换行命令。 以下是其他编辑命令：  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|将文本粘贴到命令行|CTRL + V|  
|将选择的文本复制到剪贴板|CTRL + INS|  
|将选择的文本复制到剪贴板；发送换行命令|CTRL + C|  
|将文本粘贴到命令行|SHIFT + INS|  

**标记模式**  

若要在任何时候进入标记模式，右键单击控制台标题栏中的任意位置，指向“**编辑**”，然后从打开的菜单中选择“**标记**”。 此外你也可以键入 CTRL + M。 在标记模式下，使用 ALT 键来标识自动换行选项的开始。 （如果“**启用对选定内容自动换行**”被禁用，则标记模式将在块中选择文本。）在标记模式下，按 CTRL + SHIFT + 箭头组合键，可按字符，而不是像在普通模式下按单词进行选择。 除了“**编辑文本**”部分中的选择键外，这些组合还可在标记模式中使用：  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|进入标记模式以在窗口中移动光标|Ctrl+M|  
|在标记模式下，与其他组合键结合使用开始自动换行选择|ALT|  
|按指定方向移动光标|箭头键|  
|在某页按指定方向移动光标|PAGR 键|  
|将光标移到缓冲区的开头|CTRL + HOME|  
|将光标移到缓冲区的末尾|CTRL + END|  

**导航历史记录**  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|在输出历史记录中上移一行|CTRL + 向上箭头|  
|在输出历史记录中下移一行|CTRL + 向下箭头|  
|将视区移动到缓冲区的顶部（如果命令行为空），或者删除光标左侧的所有字符（如果命令行不为空）|CTRL + HOME|  
|将视区移动到命令行（如果命令行为空），或者删除光标右侧的所有字符（如果命令行不为空）|CTRL + END|  

**其他键盘命令**  

|若要实现此目的，请执行以下操作：|使用此组合键：|  
|---------------|-----------------------------|  
|打开查找对话框|Ctrl+F|  
|关闭控制台窗口|Alt + F4|  
